# Cardio-XAI

## Overview

This project is a multi-modal Heart Disease Prediction System that supports:

* **Tabular data-based prediction** using clinical attributes
* **Medical image-based prediction** using chest X-ray images with a Convolutional Neural Network (CNN)
* **Visual explanation for image predictions** using Grad-CAM

The system is implemented using **Python, Flask, TensorFlow, and Scikit-learn**, with separate modules for model training, experimentation, and deployment.

---

## Project Structure

```
Heart_disease/
│
├── app/
│   ├── app.py
│   ├── templates/
│   │   ├── index.html
│   │   ├── tabular.html
│   │   └── image.html
│   └── static/
│       ├── uploads/
│       └── outputs/
│           └── gradcam.png
│
├── models/
│   ├── cnn_model.h5
│   ├── tabular_rf_model.pkl
│   └── tabular_features.pkl
│
├── data/
│   ├── Images/
│   │   ├── train/
│   │   └── val/
│   └── Tabular/
│       ├── heart.csv
│       └── heart_cleaned.xls
│
├── notebooks/
│   ├── cnn_model.ipynb
│   ├── gradcam.ipynb
│   ├── eda_tabular.ipynb
│   └── tabular_model.ipynb
│
├── scripts/
│   ├── create_split.py
│   └── val_split.py
│
├── README.md
└── requirements.txt
```

---

## Datasets Used

### 1. Tabular Dataset

* **Heart Disease Dataset**
* Contains clinical features such as:

  * Age
  * Sex
  * Chest pain type
  * Resting blood pressure
  * Cholesterol
  * Maximum heart rate
  * Exercise-induced angina
* Files:

  * `heart.csv`
  * `heart_cleaned.xls`

### 2. Image Dataset

* **Chest X-ray images**
* Classes:

  * Normal
  * Pneumonia
* Organized into training and validation directories:

  ```
  data/Images/train/
  data/Images/val/
  ```

---

## Model Training (Important)

### Model files (`.pkl` and `.h5`) are NOT included in this repository.

Due to file size limitations and best practices, trained model files are excluded.
Users **must train the models locally** by running the provided notebooks.

### Steps to Generate Models

#### 1. Train Tabular Model

Run:

```
notebooks/tabular_model.ipynb
```

This will generate:

* `tabular_rf_model.pkl`
* `tabular_features.pkl`

Save these files inside:

```
models/
```

#### 2. Train CNN Image Model

Run:

```
notebooks/cnn_model.ipynb
```

This will generate:

* `cnn_model.h5`

Save it inside:

```
models/
```

#### 3. Grad-CAM Experimentation

Optional visualization and verification:

```
notebooks/gradcam.ipynb
```

---

## Dataset Splitting Scripts

The `scripts/` directory contains utilities to restructure or reduce datasets if needed.

* `create_split.py`
  Used to create train/validation splits from raw image folders.

* `val_split.py`
  Used to reorganize validation data or rebalance samples.

These scripts are optional and can be used to customize the dataset size for faster experimentation.

---

## Running the Web Application

### 1. Install Dependencies

```
pip install -r requirements.txt
```

### 2. Navigate to App Directory

```
cd app
```

### 3. Run Flask Server

```
python app.py
```

### 4. Open in Browser

```
http://127.0.0.1:5000/
```

---

## Application Features

### Tabular Prediction

* User enters clinical values
* Random Forest model predicts heart disease presence
* Confidence score is displayed

### Image Prediction

* User uploads a chest X-ray image
* CNN predicts Normal or Pneumonia
* Grad-CAM heatmap is generated and displayed

---

## Notes

* Ensure all trained model files are placed inside the `models/` directory before running the app.
* Uploaded images and generated outputs are stored automatically in `app/static/`.

----

## Output Screenshots

This section presents representative outputs generated by the system during execution. Screenshots illustrate the main functionalities of the application.

> **Note:** Outputs are generated dynamically based on user input. Actual results may vary depending on the data provided.

---

### 1. Landing Page

The landing page serves as the entry point to the application, allowing users to navigate to either tabular or image-based prediction modules.

```md
![Landing Page](screenshots/landing_page.png)
```

---

### 2. Tabular Prediction Output (Heart Disease)

After submitting clinical parameters, the system displays:

* Prediction result (Heart Disease / No Heart Disease)
* Confidence score

```md
![Tabular Prediction Output](screenshots/tabular_output.png)
```

---

### 3. Image Prediction Output (Pneumonia Detection)

After uploading a chest X-ray image, the system displays:

* Predicted class (Normal / Pneumonia)
* Confidence score
* Generated Grad-CAM visualization

```md
![Prediction Output](screenshots/image_output.png)
```

---

### 4. Grad-CAM Visualization

The Grad-CAM heatmap highlights regions of the chest X-ray image that influenced the CNN’s prediction.

```md
![Grad-CAM Visualization](screenshots/gradcam_output.png)
```

---



## Author

**Akhil Shaju**
B.Tech – Artificial Intelligence & Data Science

---









